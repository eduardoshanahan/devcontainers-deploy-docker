# Audit rules for security monitoring
# This file contains the rules for the audit daemon

# Delete all previous rules
-D

# Set buffer size
-b 8192

# Make the configuration immutable
-e 2

# Audit the audit logs
-w /var/log/audit/ -k auditlog

# Auditd configuration
-w /etc/audit/ -p wa -k auditconfig
-w /etc/libaudit.conf -p wa -k auditconfig
-w /etc/audisp/ -p wa -k audispconfig

# Monitor for use of audit management tools
-w /sbin/auditctl -p x -k audit_tools
-w /sbin/auditd -p x -k audit_tools

# Monitor AppArmor configuration changes
-w /etc/apparmor/ -p wa -k MAC-policy
-w /etc/apparmor.d/ -p wa -k MAC-policy

# Monitor systemd configuration changes
-w /etc/systemd/ -p wa -k systemd
-w /lib/systemd/ -p wa -k systemd

# Monitor SSH configuration changes
-w /etc/ssh/sshd_config -p wa -k sshd
-w /etc/ssh/sshd_config.d/ -p wa -k sshd

# Monitor sudoers changes
-w /etc/sudoers -p wa -k sudoers
-w /etc/sudoers.d/ -p wa -k sudoers

# Monitor Docker configuration changes
-w /etc/docker/ -p wa -k docker
-w /var/lib/docker/ -p wa -k docker

# Monitor network configuration changes
-w /etc/hosts -p wa -k network_modifications
-w /etc/network/ -p wa -k network_modifications
-w /etc/networks -p wa -k network_modifications
-w /etc/resolv.conf -p wa -k network_modifications
-w /etc/network/interfaces -p wa -k network_modifications

# Monitor firewall configuration changes
-w /etc/ufw/ -p wa -k firewall_modifications
-w /etc/iptables/ -p wa -k firewall_modifications

# Monitor user/group changes
-w /etc/group -p wa -k identity
-w /etc/passwd -p wa -k identity
-w /etc/gshadow -p wa -k identity
-w /etc/shadow -p wa -k identity
-w /etc/security/opasswd -p wa -k identity

# Monitor cron configuration & scheduled jobs
-w /etc/cron.allow -p wa -k cron
-w /etc/cron.deny -p wa -k cron
-w /etc/cron.d/ -p wa -k cron
-w /etc/cron.daily/ -p wa -k cron
-w /etc/cron.hourly/ -p wa -k cron
-w /etc/cron.monthly/ -p wa -k cron
-w /etc/cron.weekly/ -p wa -k cron
-w /etc/crontab -p wa -k cron
-w /var/spool/cron/ -p wa -k cron

# Monitor for use of commands to change identity/authentication
-w /bin/su -p x -k privileged-priv_change
-w /usr/bin/sudo -p x -k privileged-priv_change
-w /etc/sudoers -p r -k privileged-priv_change
-w /etc/sudoers.d/ -p r -k privileged-priv_change

# Monitor for use of commands to change system administration scope
-w /etc/sudoers -p wa -k scope
-w /etc/sudoers.d/ -p wa -k scope

# Monitor for use of commands to change network configuration
-w /sbin/ip -p x -k network_modifications
-w /sbin/iptables -p x -k network_modifications
-w /sbin/iptables-restore -p x -k network_modifications
-w /sbin/iptables-save -p x -k network_modifications

# Monitor for use of commands to change system limits
-w /etc/security/limits.conf -p wa -k limits
-w /etc/security/limits.d/ -p wa -k limits

# Monitor for use of commands to change system controls
-w /etc/sysctl.conf -p wa -k system-locale
-w /etc/sysctl.d/ -p wa -k system-locale

# Monitor for use of commands to change system locale
-w /etc/default/locale -p wa -k system-locale
-w /etc/localtime -p wa -k system-locale

# Monitor for use of commands to change system time
-w /etc/adjtime -p wa -k time-change
-w /etc/localtime -p wa -k time-change

# Monitor for use of commands to change system name
-w /etc/hostname -p wa -k system-locale
-w /etc/network/ -p wa -k system-locale

# Monitor for use of commands to change system locale
-w /etc/default/locale -p wa -k system-locale
-w /etc/localtime -p wa -k system-locale

# Monitor for use of commands to change system time
-w /etc/adjtime -p wa -k time-change
-w /etc/localtime -p wa -k time-change

# Monitor for use of commands to change system name
-w /etc/hostname -p wa -k system-locale
-w /etc/network/ -p wa -k system-locale

# Monitor for use of commands to change system locale
-w /etc/default/locale -p wa -k system-locale
-w /etc/localtime -p wa -k system-locale

# Monitor for use of commands to change system time
-w /etc/adjtime -p wa -k time-change
-w /etc/localtime -p wa -k time-change

# Monitor for use of commands to change system name
-w /etc/hostname -p wa -k system-locale
-w /etc/network/ -p wa -k system-locale 